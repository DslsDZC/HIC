# HIK内核实现

## 项目概述

HIK (Hierarchical Isolation Kernel) 是一个分级隔离内核，根据三层模型文档实现。

## 架构说明

### Core-0层 (内核核心)
- **职责**: 系统仲裁者、资源管理、能力系统
- **特权级**: x86 Ring 0
- **代码行数限制**: <10,000行C代码

### Privileged-1层 (特权服务沙箱)
- **职责**: 模块化服务提供者
- **特权级**: x86 Ring 0 (物理隔离)
- **内存映射**: 物理空间直接映射

### Application-3层 (应用层)
- **职责**: 不可信用户代码
- **特权级**: x86 Ring 3
- **内存**: 虚拟地址空间

## 目录结构

```
kernel/
├── include/          # 公共头文件
│   ├── types.h       # 基础类型
│   ├── capability.h  # 能力系统
│   ├── domain.h      # 域管理
│   ├── thread.h      # 线程管理
│   └── pmm.h         # 物理内存管理
├── core/             # Core-0实现
│   ├── main.c        # 内核入口
│   └── capability.c  # 能力系统实现
├── arch/x86_64/      # x86-64架构支持
├── lib/              # 内核库
└── Makefile          # 构建系统
```

## 核心特性

### 1. 能力系统
- 细粒度权限控制
- 动态传递与撤销
- 权限派生与限制

### 2. 物理内存管理
- 直接物理地址映射
- 基于页帧的分配
- 域级配额限制

### 3. 强隔离机制
- MMU硬件隔离
- 能力验证
- 故障隔离

### 4. 模块化服务
- 独立服务沙箱
- 热插拔支持
- 滚动更新

## 编译

```bash
make
```

## 输出

- `bin/hik-kernel.elf` - ELF格式内核映像
- `bin/hik-kernel.bin` - 二进制格式内核映像

## 文档

详细设计请参考 `TD/` 目录中的文档：
- `三层模型.md` - 核心架构设计
- `引导加载程序.md` - Bootloader接口
- `可移植性.md` - 跨平台支持

## 版本

当前版本: 0.1.0 (开发中)