<!--
SPDX-FileCopyrightText: 2026 DslsDZC <dsls.dzc@gmail.com>

SPDX-License-Identifier: CC-BY-4.0
-->

# 常见问题 (FAQ)

本文档回答了关于HIC项目的常见问题。

## 项目相关

### Q: HIC是什么？

A: HIC (Hierarchical Isolation Core) 是一个新型的操作系统内核，通过统一的架构范式，构建一个能适应从资源受限的嵌入式设备到功能复杂的通用计算系统的操作系统内核。核心目标是在单一架构框架内实现极致性能、强安全隔离、动态可扩展性的三元统一。

### Q: HIC的设计目标是什么？

A: HIC的核心设计目标是：
1. **极致性能** - 接近宏内核的性能，避免传统微内核的性能开销
2. **强安全隔离** - 基于硬件MMU和软件能力系统的强隔离机制
3. **动态可扩展性** - 支持运行时模块加载和热更新

### Q: HIC与其他内核有什么区别？

A: HIC的独特之处在于：
- 采用物理内存直接映射，消除虚拟内存管理开销
- 使用能力系统进行细粒度的权限控制
- 支持静态合成和动态模块化两种部署模式
- 在同特权级运行服务，消除了特权级切换开销

详见 [项目概述](./01-Overview.md) 中的对比表格。

### Q: HIC的许可证是什么？

A: HIC使用GPL-2.0许可证。详见 [LICENSE](../../LICENSE)。

### Q: 如何为HIC做贡献？

A: 欢迎！详见 [贡献指南](./39-Contributing.md)。

## 构建相关

### Q: 如何构建HIC？

A: 有多种构建方式：

1. **使用根目录Makefile（推荐）**：
   ```bash
   make all && make install
   ```

2. **使用构建脚本**：
   ```bash
   ./build.sh
   ```

3. **使用Python构建系统**：
   ```bash
   python3 scripts/build_system.py
   ```

详见 [快速开始](./03-QuickStart.md) 和 [构建系统](./04-BuildSystem.md)。

### Q: 构建需要什么工具？

A: 必需工具：
- `make` - 构建工具
- `python3` - Python 3
- `gcc` - C编译器

可选工具：
- `gcc-mingw-w64-x86-64` - UEFI交叉编译器
- `gnu-efi` - UEFI开发框架
- `x86_64-elf-gcc` - 内核交叉编译器

### Q: 为什么需要交叉编译工具链？

A: HIC引导程序需要为UEFI环境编译，UEFI使用PE格式，需要特殊的交叉编译工具链。内核需要为特定架构编译，也需要相应的交叉编译器。

### Q: 构建需要多长时间？

A: 在现代CPU上，完整构建通常需要2-5分钟。使用并行构建（`make -j$(nproc)`）可以显著加快构建速度。

### Q: 如何加速构建？

A: 可以使用以下方法：
1. 并行构建：`make -j$(nproc)`
2. 使用ccache：安装并配置ccache
3. 增量构建：只重新构建修改的文件

### Q: 构建失败怎么办？

A: 请检查：
1. 是否安装了所有必需的工具
2. 是否有足够的磁盘空间
3. 是否有正确的权限
4. 查看 [故障排查](./38-Troubleshooting.md)

### Q: 构建产物在哪里？

A: 所有构建产物位于 `output/` 目录：
- `bootx64.efi` - UEFI引导程序
- `bios.bin` - BIOS引导程序
- `hic-kernel.bin` - 内核映像

## 运行相关

### Q: 如何运行HIC？

A: 可以在QEMU中运行或在真实硬件上运行。

**在QEMU中运行（UEFI）**：
```bash
qemu-system-x86_64 \
  -bios /usr/share/OVMF/OVMF_CODE.fd \
  -drive format=raw,file=output/bootx64.efi \
  -drive format=raw,file=output/hic-kernel.bin \
  -m 512M \
  -serial stdio
```

**在QEMU中运行（BIOS）**：
```bash
qemu-system-x86_64 \
  -drive format=raw,file=output/bios.bin \
  -drive format=raw,file=output/hic-kernel.bin \
  -m 512M \
  -serial stdio
```

详见 [快速开始](./03-QuickStart.md)。

### Q: 支持哪些架构？

A: 目前主要支持x86-64。ARM64和RISC-V的支持正在开发中。

### Q: 可以在没有UEFI的系统上运行吗？

A: 可以。HIC支持BIOS引导，使用传统的BIOS启动方式。

### Q: 如何在真实硬件上运行？

A:
1. 将引导程序写入引导扇区或EFI分区
2. 将内核映像复制到适当位置
3. 配置引导加载程序

详见 [快速开始](./03-QuickStart.md)。

### Q: 最小内存要求是多少？

A: 建议512MB以上内存。理论最小值约为128MB，但实际使用中推荐至少256MB。

### Q: 支持哪些文件系统？

A: 目前支持基本的文件系统操作。更多文件系统的支持正在开发中。

## 架构相关

### Q: 什么是三层模型？

A: HIC采用逻辑三级特权架构：
- **Core-0层** - 内核核心与仲裁者（Ring 0）
- **Privileged-1层** - 特权服务沙箱（逻辑Ring 1，物理Ring 0）
- **Application-3层** - 应用层（Ring 3）

详见 [架构设计](./02-Architecture.md)。

### Q: 什么是物理内存直接映射？

A: Privileged-1服务采用物理内存直接映射，服务直接使用物理地址，无额外的虚拟地址转换开销。这消除了虚拟内存管理的非确定性和性能开销。

### Q: 什么是能力系统？

A: 能力（Capability）是HIC中所有授权的载体。能力是不可伪造的内核对象，描述对系统资源的特定访问权限（读、写、执行）。所有资源访问都必须通过能力验证。

详见 [能力系统](./11-CapabilitySystem.md)。

### Q: 什么是静态合成模式？

A: 静态合成模式用于嵌入式、实时或高安全场景。所有服务模块在构建时编译并链接为单一、确定性的内核映像，无运行时模块加载开销。

### Q: 什么是动态模块化模式？

A: 动态模块化模式用于通用计算、桌面或服务器场景。核心服务静态编译，扩展服务可在运行时通过网络仓库安全地安装、更新和卸载。

## 安全相关

### Q: HIC如何保证安全？

A: HIC通过多种机制保证安全：
1. **硬件MMU隔离** - 每个服务运行在独立的物理内存区域
2. **能力系统** - 细粒度的权限控制
3. **安全启动** - 完整的信任链和签名验证
4. **审计日志** - 记录所有关键安全操作
5. **形式化验证** - 核心不变式的数学证明

详见 [安全架构](./13-SecurityArchitecture.md)。

### Q: 什么是安全启动？

A: 安全启动确保从固件到内核的完整信任链。每个阶段都验证下一个阶段的签名，防止未授权代码执行。

详见 [安全启动](./16-SecureBoot.md)。

### Q: 什么是审计日志？

A: 审计日志记录所有关键安全操作，如能力验证、服务创建/销毁、特权调用等。审计日志是仅追加的，其他服务无法修改。

详见 [审计日志](./14-AuditLogging.md)。

### Q: 什么是形式化验证？

A: 形式化验证使用数学方法证明系统的正确性。HIC的核心不变式都有对应的数学证明，确保系统的安全性和可靠性。

详见 [形式化验证](./15-FormalVerification.md)。

## 性能相关

### Q: HIC的性能如何？

A: HIC的性能目标：
- **系统调用延迟**: 20-30纳秒
- **中断处理延迟**: 0.5-1微秒
- **线程切换延迟**: 120-150纳秒

详见 [性能指标](./17-PerformanceMetrics.md)。

### Q: 如何优化性能？

A: HIC使用多种优化技术：
1. **快速路径** - 针对关键路径的优化
2. **物理内存直接映射** - 消除虚拟内存开销
3. **同特权级调用** - 消除特权级切换开销
4. **零拷贝通信** - 通过共享内存实现零拷贝

详见 [优化技术](./18-OptimizationTechniques.md)。

### Q: 如何测量性能？

A: 可以使用基准测试工具：
- **LMbench** - 综合性能测试
- **cyclictest** - 实时性能测试
- **自定义测试** - 针对特定场景的测试

## 开发相关

### Q: 如何设置开发环境？

A: 详见 [开发环境](./05-DevelopmentEnvironment.md)。

### Q: 代码规范是什么？

A: 详见 [代码规范](./06-CodingStandards.md)。

### Q: 如何运行测试？

A: 详见 [测试指南](./07-Testing.md)。

### Q: 如何调试？

A: 可以使用以下方法：
1. **串口输出** - 添加调试输出
2. **QEMU调试** - 使用QEMU的调试功能
3. **GDB** - 使用GNU调试器

### Q: 如何提交代码？

A: 详见 [提交指南](./40-CommitGuidelines.md)。

## 其他问题

### Q: HIC支持多核吗？

A: 是的，HIC支持多核处理器。核心-0可以管理多个CPU核心，并支持线程在不同核心上运行。

### Q: HIC支持热插拔吗？

A: 是的，HIC支持热插拔设备。热插拔协调服务负责处理设备插入和拔出事件。

### Q: HIC支持滚动更新吗？

A: 是的，HIC支持滚动更新。可以在线更新服务模块，无需重启系统。

详见 [滚动更新](./22-RollingUpdate.md)。

### Q: HIC支持容器吗？

A: HIC的设计本身就类似于容器，每个服务运行在独立的沙箱中。可以在此基础上实现更高层次的容器抽象。

### Q: HIC适合什么场景？

A: HIC适合多种场景：
- **嵌入式系统** - IoT节点、传感器、实时控制
- **通用计算** - 桌面系统、服务器、云计算
- **安全关键系统** - 航空航天、汽车电子、医疗设备

### Q: HIC的生产就绪状态如何？

A: HIC目前处于v0.1.0阶段，核心功能已实现，但还需要更多的测试和优化。计划在v1.0.0达到生产就绪状态。

### Q: 如何获取帮助？

A: 可以通过以下方式获取帮助：
1. 查看 [Wiki文档](./index.md)
2. 查看 [故障排查](./38-Troubleshooting.md)
3. 提交 [Issue](https://github.com/*/HIC/issues)
4. 加入 [讨论区](https://github.com/*/HIC/discussions)

### Q: 如何报告Bug？

A: 请提交Issue，包含以下信息：
- Bug描述
- 复现步骤
- 期望行为
- 实际行为
- 环境信息（操作系统、编译器版本等）
- 日志输出

### Q: 如何请求新功能？

A: 请提交Issue，标记为"enhancement"，详细描述你希望的功能。

---

*最后更新: 2026-02-14*