# HIC 内核编译时配置
# 此文件定义内核的编译时选项和配置

# ==================== 基础配置 ====================
CONFIG_SERIAL ?= 1         # 启用串口支持 (0=禁用, 1=启用)

# ==================== 调试配置 ====================
CONFIG_DEBUG ?= 0          # 启用调试支持 (0=禁用, 1=启用)
CONFIG_TRACE ?= 0          # 启用跟踪功能 (0=禁用, 1=启用)
CONFIG_VERBOSE ?= 1        # 启用详细输出 (0=禁用, 1=启用)

# ==================== 安全配置 ====================
CONFIG_KASLR ?= 0          # 启用内核地址空间布局随机化 (0=禁用, 1=启用)
CONFIG_SMEP ?= 1           # 启用SMEP (禁止从用户态执行内核代码)
CONFIG_SMAP ?= 1           # 启用SMAP (禁止内核访问用户态内存)
CONFIG_AUDIT ?= 1          # 启用审计日志 (0=禁用, 1=启用)

# ==================== 性能配置 ====================
CONFIG_PERF ?= 1           # 启用性能计数器 (0=禁用, 1=启用)
CONFIG_FAST_PATH ?= 1      # 启用快速路径优化 (0=禁用, 1=启用)

# ==================== 功能配置 ====================
CONFIG_PCI ?= 1            # 启用PCI支持 (0=禁用, 1=启用)
CONFIG_ACPI ?= 1           # 启用ACPI支持 (0=禁用, 1=启用)

# ==================== 内存配置 ====================
CONFIG_HEAP_SIZE_MB ?= 128           # 堆大小(MB)
CONFIG_STACK_SIZE_KB ?= 8            # 栈大小(KB)
CONFIG_PAGE_CACHE_PERCENT ?= 20      # 页面缓存百分比

# ==================== 架构配置 ====================
CONFIG_MMU ?= 1                      # 启用MMU支持 (0=禁用, 1=启用)
CONFIG_MPU ?= 0                      # 启用MPU支持 (0=禁用, 1=启用)
CONFIG_PHYSICAL_MAPPING ?= 0         # 物理内存直接映射 (0=禁用, 1=启用)

# ==================== 调度器配置 ====================
CONFIG_SCHEDULER_POLICY ?= priority  # 调度策略 (fifo, rr, priority)
CONFIG_TIME_SLICE_MS ?= 10           # 时间片长度(毫秒)
CONFIG_MAX_THREADS ?= 256            # 最大线程数

# ==================== 安全级别 ====================
CONFIG_SECURITY_LEVEL ?= standard    # 安全级别 (minimal, standard, strict)

# ==================== 能力系统配置 ====================
CONFIG_MAX_CAPABILITIES ?= 65536     # 最大能力数量
CONFIG_CAPABILITY_DERIVATION ?= 1    # 启用能力派生 (0=禁用, 1=启用)

# ==================== 域配置 ====================
CONFIG_MAX_DOMAINS ?= 16             # 最大域数量
CONFIG_DOMAIN_STACK_SIZE_KB ?= 16    # 域栈大小(KB)

# ==================== 中断配置 ====================
CONFIG_MAX_IRQS ?= 256               # 最大中断数
CONFIG_IRQ_FAIRNESS ?= 1             # 启用中断公平性 (0=禁用, 1=启用)

# ==================== 模块配置 ====================
CONFIG_MODULE_LOADING ?= 1           # 启用模块加载 (0=禁用, 1=启用)
CONFIG_MAX_MODULES ?= 32             # 最大模块数
CONFIG_MODULE_STATIC ?= 0            # 模块构建模式 (0=动态, 1=静态嵌入)
CONFIG_DISABLE_SERIAL_SERVICE ?= 0   # 禁用串口服务 (0=启用, 1=禁用)
CONFIG_DISABLE_VGA_SERVICE ?= 0      # 禁用VGA服务 (0=启用, 1=禁用)
CONFIG_DISABLE_CLI_SERVICE ?= 0      # 禁用CLI服务 (0=启用, 1=禁用)
CONFIG_ENABLE_LEGACY_SERVICES ?= 0   # 启用旧服务 (0=禁用, 1=启用)

# ==================== 使用说明 ====================
#
# 编译时配置说明：
# 1. 编译时配置在编译阶段确定，需要重新编译才能生效
# 2. 这些配置影响内核的代码生成和功能特性
# 3. 编译时配置通常用于：
#    - 硬编码的安全策略
#    - 性能优化选项
#    - 功能开关
#    - 内存布局调整
#
# 使用方法：
#
# 方法1：直接修改此文件中的配置值
#   make clean && make kernel
#
# 方法2：通过命令行参数传递
#   make CONFIG_DEBUG=1 CONFIG_TRACE=1 kernel
#
# 方法3：创建自定义配置文件
#   cp build_config.mk my_config.mk
#   编辑 my_config.mk
#   make -f my_config.mk kernel
#
# ==================== 与运行时配置的区别 ====================
#
# 编译时配置 vs 运行时配置：
#
# 编译时配置：
# - 在编译阶段确定
# - 影响代码生成和二进制大小
# - 通常用于性能优化和安全策略
# - 需要重新编译才能更改
# - 示例：MMU启用/禁用、调试支持、性能优化
#
# 运行时配置：
# - 在运行时确定
# - 通过配置文件或命令行参数传递
# - 通常用于策略和行为调整
# - 无需重新编译
# - 示例：IP地址、端口、日志级别
#
# ==================== 配置影响说明 ====================
#
# CONFIG_DEBUG=1:
#   - 启用调试信息
#   - 增加二进制大小
#   - 降低性能
#   - 仅用于开发和调试
#
# CONFIG_MMU=0:
#   - 禁用MMU，使用物理地址直接映射
#   - 适用于无MMU的嵌入式系统
#   - 减少内存管理开销
#   - 降低隔离性
#
# CONFIG_FAST_PATH=1:
#   - 启用快速路径优化
#   - 提高关键路径性能
#   - 增加代码复杂度
#   - 适用于性能关键场景
#
# CONFIG_AUDIT=1:
#   - 启用审计日志
#   - 记录所有安全相关操作
#   - 增加存储和性能开销
#   - 提高安全性和可追溯性